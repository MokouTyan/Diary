【2022.12.12】windows server部署jupyter并开放远程

### 前言

由于winserver的hyper-v还挺方便的，所以本次的想法是在win的基础上搭一个Debian，然后安装docker版的jupyter，因为docker可以开机自启动，比较方便，这样子win只作为一个宿主机，不需要我进行开机启动

### 创建虚拟机

![image-20221212104522167](https://i0.hdslb.com/bfs/album/f2fb744878cbd3a2ed6689839444b2687ae5c53a.png)

名称随意吧

![image-20221212104644953](https://i0.hdslb.com/bfs/album/32dcc8149165e95b9477157204f71f3277002823.png)

选择第二代

![image-20221212104727791](https://i0.hdslb.com/bfs/album/ab17ff72c3b5300526f99e26c8a947a57b8e3b6a.png)

选择4G，反正后期也能改

![image-20221212104812903](https://i0.hdslb.com/bfs/album/ee0f75f0d91f815eaad3502e4c89804ce9a7b73b.png)

选择网络

![image-20221212104837414](https://i0.hdslb.com/bfs/album/4c82d6972490d2ccc3bae0dd2d48acc3b692e9b7.png)

硬盘分个64G吧，反正是动态的

![image-20221212104932381](https://i0.hdslb.com/bfs/album/9e3cf8c51f0279aaf9b324570fa71d0e6e6b4a25.png)

选择Debian

![image-20221212105011154](https://i0.hdslb.com/bfs/album/b4d3c667be8c62fc4d9ad8d5dcdaec0a6033cb2c.png)

完成创建

### 配置虚拟机

设置该虚拟机，关闭安全启动

![image-20221212105156508](https://i0.hdslb.com/bfs/album/edb897a51741b3ee22b4518c2f512bf230e5a6e7.png)

分配多核

![image-20221212105125392](https://i0.hdslb.com/bfs/album/9561194d847ba48662cd795a151463182f491e37.png)

启用MAC地址欺骗

![image-20221212110006417](https://i0.hdslb.com/bfs/album/110ad7ab427e35e8ca5e09e5979b3ac19e631d00.png)

自启动看个人吧，我觉得可以随时开

![image-20221212105259563](https://i0.hdslb.com/bfs/album/d2822de7c64673bf6a6614f596b9213a70caa367.png)

### 导出虚拟机

其实本地已经有一台Debian虚拟机了，并且已经安装了docker，所以没必要再去重新安装，干脆直接拷贝

先将已有的Debian虚拟机关机，导出

![image-20221212110150380](https://i0.hdslb.com/bfs/album/1c856179d16f08747f424a96dda6cda7e4ceaa5b.png)

然后去目录下检查是否存在

![image-20221212110322400](https://i0.hdslb.com/bfs/album/333c2635ef96fbf3e3cd1f55d27575ccaeea60d6.png)

然后再导入，到这个目录下

![image-20221212110433783](https://i0.hdslb.com/bfs/album/5515293ea18521c3dcbdd45faabed9e2afad6065.png)

选择虚拟机的时候只有这一台

![image-20221212110541012](https://i0.hdslb.com/bfs/album/f6110e9582d9a1f37ec73c8f00bfcd6e5871a48e.png)

选择复制并且创建

![image-20221212110613238](https://i0.hdslb.com/bfs/album/1a08a8679be48b9e5093027c1727e7083444721a.png)

我会放在默认

![image-20221212110708928](https://i0.hdslb.com/bfs/album/4f1a2e562365b51f0b5ff4ca4f6e3c88b7d262e2.png)

![image-20221212110716491](https://i0.hdslb.com/bfs/album/11b60f30e2c3675a16ad6494915ffb87b817316f.png)

完成

### 安装Jupyter

安装docker的部分省略

```
docker pull jupyter/base-notebook:notebook-6.5.2
```

创建配置目录

```
mkdir -p /opt/jupyter/jovyan
mkdir -p /opt/jupyter/jovyan/.jupyter
chmod 777 -R /opt/jupyter/jovyan
```

映射到docker内

```
docker run --name Jupyter --restart=always -d -p 8888:8888 -v /opt/jupyter/jovyan:/home/jovyan jupyter/base-notebook:notebook-6.5.2
```

此时便可以通过IP+端口访问jupyter了

![image-20221212141455768](https://i0.hdslb.com/bfs/album/8a58355810de468ead4149ca3fd3819cd68a41b6.png)

然后根据提示，在命令行输入

```
docker exec -it Jupyter jupyter notebook password
docker restart Jupyter
```

输入两次密码，之后就可以通过密码登陆

### 设置中文

打开终端

![image-20221212143537012](https://i0.hdslb.com/bfs/album/de112ba96161555081fcb6bcebf790bf99b25400.png)

```
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
pip install jupyterlab-language-pack-zh-CN
```

修改语言

![image-20221212145646767](https://i0.hdslb.com/bfs/album/9822fc9f71052464a93c6928fb72b051079f4434.png)

### 自动补全

```
pip install jupyter_contrib_nbextensions
jupyter contrib nbextension install --user
pip install jupyter_nbextensions_configurator
jupyter nbextensions_configurator enable --user

```

### 端口转发

如果有公网ip的话，设置好端口转发就可以随时随地访问了